# Milestone v1.0: Ralph Wiggum Alignment

**Status:** SHIPPED 2026-01-11
**Phases:** 1-5
**Total Plans:** 9

## Overview

Validate and align the AutoCoder agent harness implementation with the definitive Ralph Wiggum methodology, ensuring the system follows established best practices for long-running autonomous coding agents.

## Phases

### Phase 1: Spec-Driven Architecture

**Goal**: Align feature tracking with specs-as-source-truth pattern from Ralph Wiggum
**Depends on**: Nothing (first phase)
**Plans**: 3 plans

Plans:

- [x] 01-01: Spec format & parser
- [x] 01-02: Initializer spec generation
- [x] 01-03: Hybrid approach integration

**Details:**
- Created spec_parser.py with YAML frontmatter parsing
- Defined spec format: frontmatter + H1 title + description + criteria + steps
- Updated initializer to generate specs/ directory
- AGENTS.md template for operational quick reference (<60 lines)
- Hybrid architecture: specs for content, database for status
- Auto-load specs on startup if database empty
- feature_sync_from_specs for manual spec edits

### Phase 2: Deterministic Loop

**Goal**: Ensure agent starts from known state each iteration (fresh-start architecture)
**Depends on**: Phase 1
**Plans**: 2 plans

Plans:

- [x] 02-01: Analysis & design (decision checkpoint)
- [x] 02-02: Implementation

**Details:**
- Structured claude-progress.txt with 4 sections: Session Log, Known Issues, Blocked Features, Next Session
- Selective reading via grep for structured sections only
- Session Log marked "do not read" to avoid confusing fresh context
- Session architecture documented in AGENTS.md template

### Phase 3: Backpressure Validation

**Goal**: Strengthen test/lint/type-check gates as backpressure before commits
**Depends on**: Phase 2
**Plans**: 1 plan

Plans:

- [x] 03-01: Validation gates & guardrails

**Details:**
- Added STEP 8: VALIDATION GATES (BLOCKING) before commits
- Common failure pattern guardrails with Error | Cause | Fix tables
- Backpressure principle: fix errors before proceeding
- TypeScript, Python, and Build error patterns documented

### Phase 4: Context Optimization

**Goal**: Implement markdown-over-JSON and token efficiency patterns
**Depends on**: Phase 3
**Plans**: 1 plan

Plans:

- [x] 04-01: Markdown MCP responses & token budget docs

**Details:**
- Converted 8 MCP tool responses from JSON to markdown
- format_feature_markdown helper for consistent formatting
- Token budget targets: specs ~5k, stats ~200, next ~500 tokens
- feature_create_bulk kept as JSON (initialization utility)

### Phase 5: Sandbox Hardening

**Goal**: Ensure isolated execution with understood blast radius
**Depends on**: Phase 4
**Plans**: 2 plans

Plans:

- [x] 05-01: Quick wins (CORS, symlink checks, blast radius docs)
- [x] 05-02: Process isolation (resource limits, env sanitization, allowlist audit)

**Details:**
- CORS restricted to localhost origins (5173, 8888)
- Symlink escape detection with is_symlink_escape() helper
- BLAST_RADIUS.md documenting security posture
- Resource limits helper: 300s CPU, 1GB RAM, 100MB files, 50 processes
- Environment sanitization helper with allowlist
- Command audit: 29 commands categorized (9 HIGH, 7 MEDIUM, 13 LOW risk)

---

## Milestone Summary

**Key Decisions:**

| Phase | Decision | Rationale |
|-------|----------|-----------|
| 01-01 | YAML frontmatter over JSON | More human-readable, aligns with Ralph Wiggum's "markdown over JSON" principle |
| 01-02 | Numbered prefixes (01-, 02-) for spec priority | Natural sort order, simpler than frontmatter-only |
| 01-03 | Hybrid database approach | Keep feature_create_bulk for runtime tracking |
| 02-01 | structure-progress for claude-progress.txt | Balances determinism with human observability |
| 02-02 | Session Log marked "do not read" | Prevents unstructured prose from confusing agent |
| 03-01 | Validation gates as STEP 8 before commit | Enforces quality before any commit attempt |
| 04-01 | Markdown over JSON for MCP tools | Token efficiency per Ralph Wiggum principle |
| 05-01 | Localhost-only CORS (5173, 8888) | Security hardening, no wildcard origins |
| 05-02 | Resource limits: 300s CPU, 1GB RAM | Reasonable bounds for dev tasks |

**Issues Resolved:**

- CORS configuration was over-permissive (fixed in 05-01)
- No documented blast radius (fixed in 05-01)
- No resource limits for subprocesses (helpers added in 05-02)
- No environment sanitization (helper added in 05-02)

**Issues Deferred:**

- Silent exception handling in WebSocket code
- No structured logging framework
- Test coverage gaps in core modules
- Resource limits/env sanitization helpers ready but not wired into agent subprocess

**Technical Debt Incurred:**

- Helpers (apply_resource_limits, get_safe_environment) created but not integrated into client.py or autonomous_agent_demo.py

---

_For current project status, see .planning/ROADMAP.md_
